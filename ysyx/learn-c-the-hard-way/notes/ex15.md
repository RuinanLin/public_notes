# 练习15：指针　习题解答

## 整理人：林睿楠

* 使用访问指针的方式重写所有使用数组的地方．

	略，本来ex15.c就有．<br><br>

* 使用访问数组的方式重写所有使用指针的地方．

	略，本来ex15.c就有．<br><br>

* 在其它程序中使用指针来代替数组访问．

	自己写一个程序：

	```c
	#include <stdio.h>

	int main(int argc, char *argv[]) {
		char *str_list[] = {
			"abc", "def", "ghi", "jkl", "mno"
		};

		char **p = str_list;
		int num = 5;
		for (p = str_list; p < str_list + num; p++) {
			printf("%s\n", *p);
		}

		return 0;
	}
	```

	运行结果：

	```
	abc
	def
	ghi
	jkl
	mno
	```

	符合预期．<br><br>

* 使用指针来处理命令行参数，就像处理`names`那样．

	程序如下：

	```c
	#include <stdio.h>

	int main(int argc, char *argv[]) {
		char **p = argv;
		for (p = argv; p < argv + argc; p++) {
			printf("%s\n", *p);
		}
		return 0;
	}
	```

	以`./build/ex15-4 test it`为输入，获得的输出为：

	```
	./build/ex15-4
	test
	it
	```

	符合预期．<br><br>

* 将获取值和获取地址组合到一起．

	撰写例子：

	```c
	#include <stdio.h>

	int main(int argc, char *argv[]) {
		int a = 40;
		int *p = &a;
		printf("p = %p, a = %d\n", p, *p);
		return 0;
	}
	```

	输出结果：

	```
	p = 0x7ffc9f384c9c, a = 40
	```

	符合预期．<br><br>

* 在程序末尾添加一个`for`循环，打印出这些指针所指向的地址．你需要在`printf`中使用`%p`．

	基于ex15.c修改如下：

	```
	49a50,59
	> 	
	> 	printf("---\n");
	> 
	> 	// print the addresses
	> 	for (cur_name = names, cur_age = ages;
	> 					(cur_age - ages) < count;
	> 					cur_name++, cur_age++) {
	> 		printf("%p %p\n",
	> 						cur_name, cur_age);
	> 	}
	```

	输出结果为：

	```
	Alan has 23 years alive.
	Frank has 43 years alive.
	Mary has 12 years alive.
	John has 89 years alive.
	Lisa has 2 years alive.
	---
	Alan is 23 years old.
	Frank is 43 years old.
	Mary is 12 years old.
	John is 89 years old.
	Lisa is 2 years old.
	---
	Alan is 23 years old again.
	Frank is 43 years old again.
	Mary is 12 years old again.
	John is 89 years old again.
	Lisa is 2 years old again.
	---
	Alan lived 23 years so far.
	Frank lived 43 years so far.
	Mary lived 12 years so far.
	John lived 89 years so far.
	Lisa lived 2 years so far.
	---
	0x7ffeb0d584c0 0x7ffeb0d584a0
	0x7ffeb0d584c8 0x7ffeb0d584a4
	0x7ffeb0d584d0 0x7ffeb0d584a8
	0x7ffeb0d584d8 0x7ffeb0d584ac
	0x7ffeb0d584e0 0x7ffeb0d584b0
	```

	是符合预期的连续以8递增的地址．<br><br>

* 对于每一种打印数组的方法，使用函数来重写程序．试着向函数传递指针来处理数据．记住你可以声明接受指针的函数，但是可以像数组那样用它．

	基于ex15.c的改动如下：

	```
	2a3,29
	> void print_using_index(int count, int *ages, char **names) {
	> 	int i;
	> 	for (i = 0; i < count; i++) {
	> 		printf("%s has %d years alive.\n",
	> 						names[i], ages[i]);
	> 	}
	> }
	> 
	> void print_using_pointers(int count, int *cur_age, char **cur_name) {
	> 	int i;
	> 	for (i = 0; i < count; i++) {
	> 		printf("%s is %d years old.\n",
	> 						*(cur_name+i), *(cur_age+i));
	> 	}
	> }
	> 
	> void print_using_stupid_complex_way(int count, int *ages, char **names) {
	> 	int *cur_age;
	> 	char **cur_name;
	> 	for (cur_name = names, cur_age = ages;
	> 					(cur_age - ages) < count;
	> 					cur_name++, cur_age++) {
	> 		printf("%s lived %d years so far.\n",
	> 						*cur_name, *cur_age);
	> 	}
	> }
	> 
	13d39
	< 	int i = 0;
	16,20c42
	< 	for (i = 0; i < count; i++) {
	< 		printf("%s has %d years alive.\n",
	< 						names[i], ages[i]);
	< 	}
	< 
	---
	> 	print_using_index(count, ages, names);
	28,32c50
	< 	for (i = 0; i < count; i++) {
	< 		printf("%s is %d years old.\n",
	< 						*(cur_name+i), *(cur_age+i));
	< 	}
	< 
	---
	> 	print_using_pointers(count, cur_age, cur_name);
	36,40c54
	< 	for (i = 0; i < count; i++) {
	< 		printf("%s is %d years old again.\n",
	< 						cur_name[i], cur_age[i]);
	< 	}
	< 
	---
	> 	print_using_index(count, cur_age, cur_name);
	44,49c58
	< 	for (cur_name = names, cur_age = ages;
	< 					(cur_age - ages) < count;
	< 					cur_name++, cur_age++) {
	< 		printf("%s lived %d years so far.\n",
	< 						*cur_name, *cur_age);
	< 	}
	---
	> 	print_using_stupid_complex_way(count, ages, names);
	```

	得到同样的输出．<br><br>

* 将`for`循环改为`while`循环，并且观察对于每种指针用法哪种循环更方便．

	烦死了！！！

	基于ex15.c的改动如下：

	```
	16c16,17
	< 	for (i = 0; i < count; i++) {
	---
	> 	i = 0;
	> 	while (i < count) {
	18a20
	> 		i++;
	28c30,31
	< 	for (i = 0; i < count; i++) {
	---
	> 	i = 0;
	> 	while (i < count) {
	30a34
	> 		i++;
	36c40,41
	< 	for (i = 0; i < count; i++) {
	---
	> 	i = 0;
	> 	while (i < count) {
	38a44
	> 		i++;
	44,46c50,52
	< 	for (cur_name = names, cur_age = ages;
	< 					(cur_age - ages) < count;
	< 					cur_name++, cur_age++) {
	---
	> 	cur_name = names;
	> 	cur_age = ages;
	> 	while ((cur_age - ages) < count) {
	48a55
	> 		cur_name++, cur_age++;
	```

	都差不多方便，没啥比头，爱用哪个用哪个，烦死了．
